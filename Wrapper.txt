package com.wrapper;

import java.time.Duration;
import java.util.List;
import java.util.Set;

import org.openqa.selenium.Alert;
import org.openqa.selenium.By;
import org.openqa.selenium.WebDriver;
import org.openqa.selenium.WebElement;
import org.openqa.selenium.interactions.Action;
import org.openqa.selenium.interactions.Actions;
import org.openqa.selenium.support.ui.ExpectedConditions;
import org.openqa.selenium.support.ui.Select;
import org.openqa.selenium.support.ui.WebDriverWait;

public class Wrapper {

	private WebDriver driver;

	public void selectByValue(WebElement pElement, String pValue) {
		Select selector = new Select(pElement);
		selector.selectByValue(pValue);

	}

	public void selectByVisibleText(WebElement element, String pValue) {

		Select selector = new Select(element);
		selector.selectByVisibleText(pValue);
	}

	public void moveToElement(WebDriver driver, WebElement element) {

		Actions builder = new Actions(driver);
		Action contextClickElement = builder.moveToElement(element).contextClick().build();
		contextClickElement.perform();
	}
	// Select an Element -- UL/LI Selector
		public List<WebElement> selectElement(WebDriver driver, WebElement pSelectElement, String pDropDownElementPath) {

			pSelectElement.click();
			List<WebElement> pDropDownElement = driver.findElements(By.xpath(pDropDownElementPath));
			return pDropDownElement;
		}

	public void windowHandle(WebDriver driver) throws InterruptedException {

		// To get the current window handle.
		String currentWindow = driver.getWindowHandle();
		// To get all window handles.
		Set<String> allWindows = driver.getWindowHandles();
		for (String temp : allWindows) {
			driver.switchTo().window(temp);
			Thread.sleep(1000);
		}
		driver.switchTo().window(currentWindow);
	}

	public void iFrameHandler1(WebDriver driver, WebElement element) {
		driver.switchTo().frame(element);
	}

	public void waitForElement1(WebElement pElement) {
		WebDriverWait wait = new WebDriverWait(driver, Duration.ofSeconds(50));
		wait.until(ExpectedConditions.elementToBeClickable(pElement));
	}

	// Window-Tabs Handle
	public void windowHandle1(WebDriver driver) throws InterruptedException {

		// To get the current window handle.
		String currentWindow = driver.getWindowHandle();
		// To get all window handles.
		Set<String> allWindows = driver.getWindowHandles();
		for (String temp : allWindows) {
			driver.switchTo().window(temp);
			Thread.sleep(5000);
		}
		driver.switchTo().window(currentWindow);
	}

	public void iFrameHandler(WebDriver driver, WebElement element) {
		driver.switchTo().frame(element);
	}
	//context click
	
	public void waitForElement(WebElement pElement) {
		WebDriverWait wait = new WebDriverWait(driver, Duration.ofSeconds(30));
		wait.until(ExpectedConditions.elementToBeClickable(pElement));
	}

	public void waitForAlert() {
		WebDriverWait wait = new WebDriverWait(driver, Duration.ofSeconds(30));
		wait.until(ExpectedConditions.alertIsPresent());
	}

	public void alertAccept() {
		Alert alert = driver.switchTo().alert();
		alert.accept();
	}

	public String getAlertText() {
		Alert alert = driver.switchTo().alert();
		return alert.getText();
	}
}
